# 除外場（Track Exclusions） 正本

## 目的
- 「除外場」は、ROI/回収/運用本数（CAPなど）に直結する重要要素。
- チャット切替で漏れると検証結果の解釈が崩れるため、**ここを正本**として管理し、毎回の引継ぎに必ず含める。

## 現状（初期値）
- 既定は **除外なし**（exclude_jcd = []）。
- 除外を運用に入れる場合は、必ず「理由」「期間」「期待効果（ROI/欠落回避/工数）」を明記し、JSONも更新する。

## 運用ルール（不変）
- 検証・実践の出力には **exclude_jcd を必ず明記**する（空でも「none」と書く）。
- TOP10CAPなど、日次本数制約がある検証は、除外の有無で結果が大きく変わりうるため、比較は必ず同条件で行う。

## 除外リスト（運用）
- updated: 2026-01-06
- source_of_truth: `C:\work\boatrace\config\exclusions.json`
- excluded_jcd: `03,06,07,08,11,12,13,14,16,18,19,20,21,23,24`（15場）

### 定義：Core5（= excluded_jcd 15場）の算出条件（固定・再現用）

目的：
- Core5 は「当てやすい場を選ぶ」ではなく、**全場運用の長期ROI最大化のために “除外する場” を固定**するための運用設定。

前提（世界線）：
- Core5 の算出・評価は **BT（operation / C型）** の世界で行う（運用制約＝CAP/除外を前提）。
  - BL（analysis / 再計算型）は性能評価（制約なし）であり、ここに Core5（除外）を混ぜない。

算出に使う入力（source of truth）：
- 除外の正：`C:\work\boatrace\config\exclusions.json`（この中の `excluded_jcd` が Core5 の実体）
- what-if 評価：CAP10+EXCL10 v2（同一入力→同一出力になる版）で候補セットを比較
- payouts：同一ファイルを固定して使用（窓比較の世界線ズレ防止）

算出手順（固定）：
1) 固定窓（例：2025-10-08..2025-12-30）を宣言する（この窓で比較し、それ以外で「採用根拠」は再計算しない）
2) CAP10+EXCL10 v2 の what-if を実行し、候補セット（例：core3 / core5）を同条件で比較する
3) ROI（invest/return）と再現性（key_overlap_rate 等）で採用を決める
4) 採用した Core5 を `exclusions.json` に反映し、以後の運用はこのファイルを正とする
5) 出力には毎回 `exclude_jcd` を明記（空なら none と書く）

採用根拠（固定窓での確定値）：
- 固定窓（2025-10-08..2025-12-30）で CAP10+EXCL10 v2 what-if を実施し、core5（追加: 19,21,24,13,16）を本採用。
- 本採用後に `run_candidate_cap10_excl10.ps1` で ROI が再現（key_overlap_rate=1.0）。


### 根拠（直近の確定）
- 固定窓（2025-10-08..2025-12-30）で CAP10+EXCL10 v2 の what-if を実施し、Core5（+13,16,19,21,24）を本採用。
  - core3（追加: 19,21,24） ROI=1.640620（invest=8.23M / return=13.5023M）
  - core5（追加: 19,21,24,13,16） ROI=1.693739（invest=8.13M / return=13.7701M）※採用
- 本採用後に `run_candidate_cap10_excl10.ps1` で ROI=1.693739 が再現（key_overlap_rate=1.0000）。

### 追加検証（ローリング窓 / 2026-01-06 実施）
- payouts_fixed: `C:\work\boatrace\runs\payouts_all_2025-10-02_2025-12-30_MERGED_keynorm.csv`
- 窓別ROI（core3=Core5から{13,16}を外した比較対象 / core5=現行運用）:
  - W1_30d（2025-10-08..2025-11-06）: core3=2.11044 / core5=2.11044（同等）
  - W2_30d（2025-11-07..2025-12-06）: core3=1.31322 / core5=1.30454（core3僅差）
  - W12_60d（2025-10-08..2025-12-06）: core3=1.71048 / core5=1.70612（core3僅差）
  - W3_30d（2025-12-01..2025-12-30）: core3=1.21756 / core5=1.35425（core5明確に優位）
- 結論：**直近30d（W3）で core5 が明確に勝つ**ため、運用は core5（現行 `exclusions.json`）を継続採用する。

### 除外対象一覧（運用ON）
| jcd | 場 | 理由 | 適用レンジ | 状態 |
|---:|---|---|---|---|
| 3 | 江戸川 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 6 | 浜名湖 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 7 | 蒲郡 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 8 | 常滑 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 11 | びわこ | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 12 | 住之江 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 13 | 尼崎 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 14 | 鳴門 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 16 | 児島 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 18 | 徳山 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 19 | 下関 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 20 | 若松 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 21 | 芦屋 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 23 | 唐津 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
| 24 | 大村 | 運用判断（ROI/回収の改善目的） | 2025-10-08..（暫定） | 運用ON |
